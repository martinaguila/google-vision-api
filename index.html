<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Cloud Vision Quickstart</title>
</head>
<body>
    <h1>Google Cloud Vision Quickstart</h1>
    
    <!-- Input for image file -->
    <input type="file" accept="image/*" id="imageInput">
    <button onclick="processImage()">Upload and Analyze</button>

    <script>
        // Function to handle image upload
        function processImage() {
          const input = document.getElementById('imageInput');
          const file = input.files[0];

          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const imageData = e.target.result.split(',')[1]; // Extract the base64-encoded data

              // Call the quickstart function with the base64-encoded image data
              quickstart(imageData);
            };
            reader.readAsDataURL(file);
          } else {
            console.error('No file selected');
          }
        }

        async function quickstart(imageData) {
        const apiKey = ''; // Replace with your Google Cloud API key

        try {
          const response = await fetch(
            `https://vision.googleapis.com/v1/images:annotate?key=${apiKey}`,
            {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                requests: [
                  {
                    image: {
                      content: imageData, // Pass the base64-encoded image data directly
                    },
                    features: [
                      { type: 'LABEL_DETECTION' },
                      { type: 'TEXT_DETECTION' }, // Add features for text detection
                      { type: 'LOGO_DETECTION' }, // Add features for logo detection
                      // Add more features as needed
                    ],
                  },
                ],
              }),
            }
          );

          const data = await response.json();

          // Check for errors in the response
          if (data.error) {
            console.error('Error from Google Cloud Vision API:', data.error.message);
            return;
          }

          // Display results in the HTML body
          const resultsContainer = document.createElement('div');
          resultsContainer.innerHTML = '<h2>Results:</h2>';

          // Labels
          const labels = data.responses[0].labelAnnotations;
          if (labels) {
            const labelsElement = document.createElement('p');
            labelsElement.textContent = 'Labels: ' + labels.map(label => label.description).join(', ');
            resultsContainer.appendChild(labelsElement);
          }

          // Text
          const texts = data.responses[0].textAnnotations;
          if (texts) {
            const textElement = document.createElement('p');
            textElement.textContent = 'Text: ' + texts.map(text => text.description).join(', ');
            resultsContainer.appendChild(textElement);
          }

          // Logos
          const logos = data.responses[0].logoAnnotations;
          if (logos) {
            const logosElement = document.createElement('p');
            logosElement.textContent = 'Logos: ' + logos.map(logo => logo.description).join(', ');
            resultsContainer.appendChild(logosElement);
          }

          document.body.appendChild(resultsContainer);
        } catch (error) {
          console.error('Error:', error.message);
        }
      }
    </script>
</body>
</html>
